\chapter{Using \dtypkgu{}}
\label{chap:using_epspline}

	\section{The Main Window Interface}%WX%3||||
	\label{sec:window_interface}
	The elements of the \IXarg{interface} presented by \IXpkg{}
	have an arrangement that has been common in
	windowing systems for many years, and will probably
	seem familiar to most users. Most individual elements are common,
	but a few are specific to \IXpkg{}. A few are similar
	to common elements in most windowed applications,
	but with some difference in behavior.

	The main groups of \IXarg{interface} elements are
	discussed briefly, from the top down in order of appearance,
	in the following subsections. An image of the main window
	is shown in figure~\ref{fig:bezier_linked_control_points}.

		\subsection{The Title Bar}%WX%4||||
		\label{ssec:title_bar}
		The \IXnewterm{title bar} is not actually part of
		the interface provided by an application. It is
		created and managed, if it exists at all, by a
		component of the windowing system. When present,
		it is usually similar for most applications. Some
		windowing systems (or system configurations) do not
		attach a \IXarg{title bar} to the application window,
		and may use another graphical device such as a
		single `bar' at the top of the screen that will
		change to represent any window that has the \emph{focus}.
		
		Regardless of the way in which a \IXarg{title bar}
		might be presented, an application such as \IXpkg{}
		has little control over it. The presence and position
		of buttons on the \IXarg{title bar}, for example,
		are a feature of the system. \IXpkgu{} only sets
		the text of the title.

		\subsection{The Menu Bar}%WX%4||||
		\label{ssec:menu_bar}
		The \IXarg{menu} ``bar'' consists of the labels, arranged
		horizontally, nearest the top of the window. Each
		label can be selected with the \IXarg{mouse} and
		will produce a small rectangular window, the
		\IXnewterm{menu}, with selectable labels, or
		\emph{items}.
		
		Selecting a \IXarg{menu} item invokes an action
		such as saving or closing data. When an item does not
		make sense for the current state of the data, it
		cannot be selected, and this is indicated by showing the
		label ``greyed,'' or dimmed, in appearance.
		
		Many of the \IXarg{menu} item labels have additional text,
		usually near the right-side edge, such as ``Ctrl+S.''  These
		indicate combinations of keys that will invoke the
		action associated with the \IXarg{menu} item without
		selecting the \IXarg{menu} with the mouse. These
		key combinations are often called ``accelerators.''
		
		In the following subsections on the menus, the \IXarg{menu}
		items are presented in tables with short descriptions of
		the associated actions. Items that differ from
		common use or are unique to \IXpkg{} are described in
		more detail following the table.
		Also, note that the accelerator keys that are shown
		may differ from those seen in a running instance of
		\IXpkg{}. The current windowing \IXarg{toolkit} or environment
		might provide accelerators for some common \IXarg{menu}
		items, and \IXpkg{} might use them.

			\subsubsection{The File Menu}%xxxWX%5||||
			\label{sssec:files_menu}
			This \IXarg{menu} provides items that generally
			apply to the current data, or ``file.''

			\begin{table}[htbp]
			\centering
			\textsf{
			\begin{tabular}[c]{ | l | l || p{5.33cm} | }
			\hline
			\textsc{Item}: & \textsc{Keys}: & \textsc{Action}:\\ \hline
			\hline \hline
			Save & Ctrl+S & save data with current name\\ \hline
			Save As & --- & save data with a new name\\ \hline
			New & Ctrl+N & create a tab for new data\\ \hline
			Open Here & --- & open (load) file data in current tab\\ \hline
			Open & Ctrl+O & open (load) file data in a new tab\\ \hline
			Close & Ctrl+W & close the data (file), leave tab\\ \hline
			Close Tab & --- & close the data (file), close tab\\ \hline
			Export & Ctrl+E & save the data as \IXpov{} \IXarg{SDL}\\ \hline
			Export As & --- & save as \IXarg{SDL} with a new name\\ \hline
			\hline
			Quit & Ctrl+Q & quit the \textrm{\dtythispkgname{}} program\\ \hline
			\end{tabular}
			}%\textsf
			\caption{The Items of the File Menu}
			\label{tab:File_menu}
			\end{table}

			The unusual items that need more explanation are:
			\begin{description}
			  \item[New] The action is to create a new tab in the
			  tabbed interface, without contents, suitable for
			  creating a new work. Alternatively, a file can be opened
			  in the new empty tab with ``Open Here.''
			  \item[Open Here] Open a file and load the data into
			  the current tab. If the tab contains data with
			  unsaved changes the user will be asked whether to
			  proceed (which will close the current file,
			  discarding changes) or cancel.
			  \item[Close Tab] This will close the file data
			  \emph{and} the tab, while the item ``Close''
			  will only close the file data, and leave the tab
			  open and empty. If there are unsaved changes the
			  user will be prompted.
			  \item[Export] \IXpkgu{} saves files in its own
			  simple format; to use the data with \IXpov{}
			  it must be ``exported'' to \IXarg{SDL}. This item
			  will export the data to a file with an existing
			  name that had be given with ``Export As.''
			  \item[Export As] Like ``Export'' but shows a file
			  selector dialog window so that the user may provide
			  a file name. This is necessary the first time the
			  file is exported; thereafter ``Export'' can be used
			  to overwrite the current file with changes. (Note that
			  the file name suffix `.inc' is commonly used for
			  such \IXarg{SDL} fragments, but it is not required by
			  \IXpov{} or appended by \IXpkg.)
			\end{description}

			\subsubsection{The Edit Menu}%xxxWX%5||||
			\label{sssec:edit_menu}
			This \IXarg{menu} provides items that
			affect or change the current data.

			\begin{table}[htbp]
			\centering
			\textsf{
			\begin{tabular}[c]{ | l | l || p{5.33cm} | }
			\hline
			\textsc{Item}: & \textsc{Keys}: & \textsc{Action}:\\ \hline
			\hline \hline
			Undo & Ctrl+Z & revert the last change made\\ \hline
			Redo & Ctrl+R & do again a change that was reverted\\ \hline
			\hline
			Copy & Ctrl+C & copy the selected object onto internal ``clipboard''\\ \hline
			Cut & Ctrl+X & remove, after copying the selected object onto internal ``clipboard''\\ \hline
			Delete & --- & remove selected object\\ \hline
			Paste & Ctrl+V & place an object from internal ``clipboard'' in the data\\ \hline
			Copy Global & --- & like ``Copy'', onto a ``clipboard'' available to all tabs\\ \hline
			Cut Global & --- & like ``Cut'', onto a ``clipboard'' available to all tabs\\ \hline
			Paste Global & --- & like ``Paste'', from a ``clipboard'' available to all tabs\\ \hline
			\hline
			Down & --- & move the selected object down in $z$-order\\ \hline
			Up & --- & move the selected object up in $z$-order\\ \hline
			\end{tabular}
			}%\textsf
			\caption{The Items of the Edit Menu}
			\label{tab:Edit_menu}
			\end{table}

			The unusual items that need more explanation are:
			\begin{description}
			  \item[Copy, Cut, Paste] These item names are common
			  in windowing system programs, but in \IXpkg{} data
			  is \emph{not} placed on a system ``clipboard,'' but
			  is only available within \IXpkg. Moreover, data
			  copied or cut by these items can only be pasted into
			  the same tab.
			  \item[Copy, Cut, Paste --- Global] These differ from
			  the items without ``Global'' only in that data
			  copied or cut from one tab is available to be pasted
			  into the data of another tab.
			  \item[Down, Up] The drawing area may have several
			  objects, and these are kept in a stacking order, or
			  ``$z$-order.'' This may not be apparent in the
			  two-dimensional interface, but will be noticed when
			  the user attempts to select an object that is below
			  another. In such a case, it might be necessary
			  to move the obstructing object down in the order
			  to make the wanted object selectable. Note that
			  there is one $z$-order for all objects, even
			  those that don't overlap, so it might be necessary
			  to select ``Down'' several times (and on more
			  than one object) before the wanted
			  object is no longer obstructed. If the wanted object
			  can be selected, but only around the edges of an
			  obstructing object, then ``Up'' can be used to
			  raise the selection and make it easier to select
			  with the next attempt. Note also that the
			  stacking or $z$-order has no effect on the way
			  \IXpov{} will render the objects, and will only affect
			  the order in which the objects appear in exported
			  \IXarg{SDL}.
			\end{description}
			
			A final note on the ``clipboard'': it's an omission
			that the system clipboard is not used. It would be
			useful if a selection could be copied (or cut) to
			the system clipboard as a \IXarg{SDL} fragment
			which could be pasted into a text editor. Likewise,
			an attempt could be made to paste from the system
			clipboard, if in text form, by trying to parse a
			prism or lathe definition in \IXarg{SDL}. This
			feature might be added in the future if \IXpkg{}
			warrants more work.

			\subsubsection{The Tools Menu}%xxxWX%5||||
			\label{sssec:tools_menu}
			This \IXarg{menu} has miscellaneous items that
			are specific to \IXpkg.

			\begin{table}[htbp]
			\centering
			\textsf{
			\begin{tabular}[c]{ | l | l || p{5.33cm} | }
			\hline
			\textsc{Item}: & \textsc{Keys}: & \textsc{Action}:\\ \hline
			\hline \hline
			Set Scale & --- & show a dialog to set arbitrary scale of display\\ \hline
			Cycle Scale & --- & cycle scale of display through normal, large, and small\\ \hline
			Toggle Quick Drawing & --- & switch between anti-aliased, and not, outlines\\ \hline
			Save Visible to File & --- & save the visible part of drawing area to an image file\\ \hline
			\end{tabular}
			}%\textsf
			\caption{The Items of the Tools Menu}
			\label{tab:Tools_menu}
			\end{table}

			The Tools \IXarg{menu} items all need explanation:
			\begin{description}
			  \item[Set Scale] The view of the drawing area can be
			  displayed with a scaling factor. This feature uses a
			  capability provided by the \IXarg{\emph{wxWidgets}}
			  library; that is, \IXpkg{} is not drawing lines at
			  different scales, but the view in the window is scaled.
			  Therefore, with a large scale lines (and all drawn
			  items) will appear thicker, and details such as
			  anti-aliasing will become apparent. With a small scale,
			  some lines of one-pixel--width are lost. Nevertheless,
			  this feature can be useful at times. Generally, most
			  work will be easiest at 100\% (normal) scale.
			  \item[Cycle Scale] This is a quick way to rotate through
			  100\%, 200\%, and 50\% scales, and is probably more
			  generally useful than ``Set Scale.''
			  \item[Toggle Quick Drawing] The object outlines, the
			  curves, are drawn by default with anti-aliasing. The
			  alternative drawing method, the ``quick'' method, simply
			  uses several simple lines drawn with
			  \IXarg{\emph{wxWidgets}}' graphics \IXnewterm{API} calls
			  to approximate the curve forms. The latter is not
			  likely to be useful unless the drawing area is on
			  a display to which raster image data transfers are
			  slow. Most modern computers are much faster than
			  necessary for the anti-aliased drawing if the the
			  display is on the same machine that is running \IXpkg.
			  If the display is not on the same host that is running
			  \IXpkg, the anti-aliased drawing might be too slow to
			  be usable (particularly over a slow link such as
			  802.11). That is because the anti-aliasing must be
			  done on a raster image, and the whole image,
			  which is a large chunk of data, transferred to the display.
			  With ``quick drawing'' the \IXarg{API} line drawing
			  is accomplished with small data transfers, and will
			  be quicker, and probably usable (but less accurate
			  in appearance).
			  \item[Save Visible to File] The part of the drawing area
			  that is visible within the \emph{scrolled} window can
			  be saved to a raster image file. This is (the remains
			  of) a development feature, and as it is difficult to
			  imagine how it might be useful to users, it is likely
			  to be removed at some point. It remains, for now,
			  mostly because it is harmless and adds very little
			  size.
			\end{description}
			
			Note on ``Toggle Quick Drawing'': above, it was said
			that anti-aliased drawing is the default. There is an
			exception under the \IXarg{\emph{X Window System}},
			where the ``DISPLAY'' environment variable is checked
			for a host component, i.e., ``somehost:0.0'' rather
			than simply ``:0.0''. If a host part is found, even
			if it is \emph{localhost}, the default will be switched
			to ``quick'' (not anti-aliased) drawing, on the obvious
			assumption that the display is remote (or remote-like).
			Of course, the user may still select
			``Toggle Quick Drawing'' and decide whether performance
			with ant-aliasing is acceptable.
			
			\subsubsection{The Help Menu}%xxxWX%5||||
			\label{sssec:help_menu}
			This \IXarg{menu} appears in most windowing system
			applications, and provides items that might
			be helpful in some way.

			\begin{table}[htbp]
			\centering
			\textsf{
			\begin{tabular}[c]{ | l | l || p{5.33cm} | }
			\hline
			\textsc{Item}: & \textsc{Keys}: & \textsc{Action}:\\ \hline
			\hline \hline
			Help & Ctrl+H & show the \IXpkg{} online help\\ \hline
			\hline
			Preview & --- & invoke \IXpov{} with temporary \IXarg{SDL} to view the work\\ \hline
			\hline
			About & --- & show the ``About'' window\\ \hline
			\end{tabular}
			}%\textsf
			\caption{The Items of the Help Menu}
			\label{tab:Help_menu}
			\end{table}

			Additional explanation:
			\begin{description}
			  \item[Help] This will show (or bring to the
			  forefront, if already shown) a \IXnewterm{help viewer}
			  window with the ``Contents'' Chapter visible.
			  (The \IXarg{help viewer} is a non-trivial piece of
			  software provided entirely by \IXarg{\emph{wxWidgets}},
			  and much to its credit --- developers take note.)
			  \item[Preview] The \IXpov{} preview does not attempt
			  to make a very nice rendering. It does attempt to
			  make an image with a perspective that includes all
			  objects. Only a few simple colors are used. Although
			  crude, the preview will often be useful. An important
			  thing to note is that \IXpkg{} does not delete the
			  temporary \IXarg{SDL} files and output until the
			  running \IXpov{} has been quit. If \IXpkg{} is
			  quit while a \IXpov{} child is still running, temporary
			  files are left in place.
			  \item[About] The ``About'' window includes copyright
			  and license information.
			\end{description}
			
			A further note on the preview: \IXpov{} for Unix-like
			systems is based on a command-line interface, but can
			also draw in real-time to a simple \IXnewterm{X}
			window, and this suits the preview well. \IXpov{}
			will quit with a single click on its window, or the
			\emph{Q} key. \IXpov{} for Microsoft Windows is quite
			different. That version will show an interactive control
			and editing window before the real-time display window,
			and might prompt the user with several dialog windows
			too (and might even play a little music). It is a nice
			tool for developing \IXpov{} images, but it is a little
			awkward when used for a simple preview by another
			program. Nevertheless,
			the preview remains useful. The Microsoft Windows version
			of \IXpov{} is quit with a menu or button; not a click.
			The same caveat about quiting \IXpkg{} with
			a child \IXpov{} instance running applies.


		\subsection{The Tool Bar}%WX%4||||
		\label{ssec:tool_bar}
		The \IXnewterm{tool} bar just below the \IXarg{menu}
		bar. It is a row of buttons with icons that can be
		clicked to invoke actions. Each action available on
		the \IXarg{tool} bar is equivalent to a \IXarg{menu} item
		action. Naturally, the \IXarg{tool} bar will be more
		convenient while working than the equivalent \IXarg{menu}
		items. From left to right, the \IXarg{tool} bar
		items are:

			\begin{description}
			  \item[Quit] Same as ``Quit'' in the
			  ``File'' \IXarg{menu}.
			  \item[Open New Tab] Same as ``New'' in the
			  ``File'' \IXarg{menu}.
			  \item[Open] Same as ``Open'' in the
			  ``File'' \IXarg{menu}.
			  \item[Save] Same as ``Save'' in the
			  ``File'' \IXarg{menu}.
			  \item[Paste] Same as ``Paste'' in the
			  ``Edit'' \IXarg{menu}.
			  \item[Copy] Same as ``Copy'' in the
			  ``Edit'' \IXarg{menu}.
			  \item[Cut] Same as ``Cut'' in the
			  ``Edit'' \IXarg{menu}.
			  \item[Move Down] Same as ``Down'' in the
			  ``Edit'' \IXarg{menu}.
			  \item[Move Up] Same as ``Up'' in the
			  ``Edit'' \IXarg{menu}.
			  \item[Undo] Same as ``Undo'' in the
			  ``Edit'' \IXarg{menu}.
			  \item[Redo] Same as ``Redo'' in the
			  ``Edit'' \IXarg{menu}.
			  \item[Cycle Scale] Same as ``Cycle Scale'' in the
			  ``Tools'' \IXarg{menu}.
			  \item[Preview] Same as ``Preview'' in the
			  ``Help'' \IXarg{menu}.
			  \item[Show Application Help] Same as ``Help'' in the
			  ``Help'' \IXarg{menu}.
			\end{description}
			
		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgUsingA}
		\caption{\dtypkgu{}'s tool bar.}
		\label{fig:tool_bar_1}
		\end{figure}

		Figure~\ref{fig:tool_bar_1} shows the \IXarg{tool}
		bar with its buttons. The icons shown are from a
		\IXnewterm{desktop} \emph{theme}, and may be
		different for each theme, in the \IXarg{GTK2} version
		of \IXpkg{}. In other versions a set of icons included
		with \IXarg{\emph{wxWidgets}} is used.
		Depending on the current platform, it might be possible
		to grab the \IXarg{tool} bar and drag it off the
		main window, and, of course, back onto the window.


		\subsection{The Tab Selection Area}%WX%4||||
		\label{ssec:tab_area}
		The \IXnewterm{tab} area is between the \IXarg{tool}
		bar and the \IXarg{drawing area}. There may be one or
		several \IXarg{tabs} present. \IXpkgu{} uses tabs to
		allow holding several sets of data, or files, open at
		once. Each \IXarg{tab} functions like a button: when
		the tab is clicked the associated data is brought to the
		front (i.e., shown). Each tab has a label with the name
		of its file, or symbolic text meant to suggest that the
		data has not been saved to a file yet (or the tab is empty).
		
		As of \IXarg{\emph{wxWidgets}} version 2.8 two forms
		of tabs are available: a simple type available in previous
		versions, and a new type with more features. The simple
		type does not provide a close button on the \IXarg{tabs},
		and the order cannot be rearranged. The new type does
		provide for close buttons, and a \IXarg{tab} can be
		dragged with the mouse to a new position among the others.
		The new type also provides for a button at the right
		side of the \IXarg{tab} area, which produces a \IXarg{menu}
		of the available tabs for direct selection; this is
		convenient when there are many \IXarg{tabs} and some
		cannot be seen due to lack of space.
		
		\IXpkgu{} uses the new type of \IXarg{tabs} by default
		(except when built with \IXarg{\emph{wxWidgets}} 2.6).
		There is little reason to use the simple type, and to
		do so requires setting a condition when the program is
		built from source (which is left as an exercise for those
		so inclined).
		

		\subsection{The Drawing Area and Canvas}%WX%4||||
		\label{ssec:drawing_area}
		This is where the work is done. At the top and
		to the left are graduated scales, and as the mouse
		is moved in the \IXnewterm{drawing} area a thin line
		is drawn on the scales to help locate the mouse active
		point with precision. To the right and at the bottom
		are scroll bars to move the visible part of the
		\IXarg{drawing} area.
		
		The `real' drawing area may also be called the
		\IXnewterm{canvas}.
		The \IXarg{canvas} has a white background with a grid
		of thin blue lines. This is meant to suggest physical
		\IXnewterm{graph paper}. (In the future there
		may be an option to disable the grid; there is none now).


		\subsection{The Status Bar}%WX%4||||
		\label{ssec:status_bar}
		The \IXnewterm{status} bar is at the bottom of
		the main window. It accepts no input; it exists
		only to provide information.
		
		The \IXarg{status}
		bar has three sections, or ``panes.'' The left, and
		longest, pane shows details about a selected object,
		such as its name and type, and if it is a prism, the
		type and extent of its \IXnewterm{sweep}. The left
		pane also shows temporary help messages associated
		with \IXarg{tool} bar or \IXarg{menu} items. Such help
		messages are shown when the mouse is over the item, and
		any original text is restored when the mouse leaves the item.
		The pane in the middle shows the coordinates of the
		mouse pointer (the pointer's active spot). The right
		pane shows the scale at which the drawing area is displayed.
		Also, if there are unsaved changes to the data, the
		right pane will show an asterisk.


	\section{Creating and Editing}%WX%3||||
	\label{sec:creat_editing}
	Working with \IXpkg{} is working with \IXarg{spline} curves.
	\IXarg{Spline} curves are common to many programs of
	several types, such as `drawing' programs and typeface
	editors. Of course, any such program must design a
	means of using an input device, usually a \IXnewterm{mouse},
	to place splines on the drawing area. Programs meant
	for drawing might devise powerful and intuitive mouse
	interactions that focus on a graphical result.
	\IXpkgu{} does not. In \IXpkg{}, placing spline
	objects on the drawing area is meant to follow the
	\IXpov{} \href{\URLPOVdocs}{documentation}
	on
	\href{\URLPOVdocsLathe}{lathe}
	and
	\href{\URLPOVdocsPrism}{prism}
	objects.

	As mentioned in \nameref{ssec:intro_epspline},
	there is an important difference
	in the ways \IXpov{} will render prisms and lathes.
	The prism is extended (like an ``extrusion'') along the
	$y$-axis. Therefore, the spline object for the prism
	is drawn parallel to the $x$-$z$ plane in three-dimensional space.
	The lathe is rotated \emph{around} the $y$-axis. So, its
	spline object is drawn parallel to the $y$-axis. Put another way,
	when editing with \IXpkg{}, if the object is a prism
	then the user's \IXnewterm{view} is parallel to the
	$y$-axis, and perpendicular to the $x$-$z$ plane. If the
	object is a lathe, the view is perpendicular to the $y$-axis
	(and $x$-axis, even though the lathe is rotated).
	
	Editing with \IXpkg{}, the user may mix prism and lathe
	objects in the same file, but should remember that the
	\emph{view} of each type is different. When generating
	temporary \IXarg{SDL} for a preview with \IXpov{}, \IXpkg{}
	adds a \IXarg{rotate} transform to the prism objects
	so that the preview will be more useful. \IXpkgu{} does
	not rotate objects in \IXarg{SDL} exported for
	inclusion in the user's scene, so the user must add
	rotations as necessary.
	
	The coordinate system of the \IXarg{drawing area} in \IXpkg{}
	is, frankly, simply the most convenient for the programming
	of \IXpkg{}. The graduated scales beside the drawing area
	will make it clear that the vertical axis increases
	in the down direction. This is easily corrected using
	transforms available in the \IXarg{SDL}, and will be discussed
	in the section~\nameref{sec:useful_transforms}.

	Hopefully, the following subsections will be clear enough
	to get started and begin realizing ideas. Where
	this document is insufficient, the \IXpov{}
	\href{\URLPOVdocs}{documentation} should help;
	it is necessary to understand how \IXpov{} handles the
	prism and the lathe objects.
	Although the following subsections are not written as a
	step-by--step tutorial, it should be possible
	(and it is suggested) to follow along with a running
	instance of \IXpkg{}.

		\subsection{Creating New Objects}%WX%4||||
		\label{ssec:creating_newobj}
		Started without file arguments, \IXpkg{}'s
		main window will open with one empty tab.
		The drawing area (the area with the grid
		of light blue lines) is ready, but note that it
		doesn't respond to a (primary) mouse click alone. To start
		a new spline, press and hold the \IXnewterm{shift}
		key and click a suitable point with the primary
		mouse button. For practice, a ``suitable'' point
		might be anywhere. A small red-filled circle should
		appear at the point of the mouse click, and that is
		the first control point. Release the shift key to
		continue placing control points. Another shift+click
		before completing at least one spline \IXnewterm{segment}
		will cancel, and the control points placed so far will be
		removed. (Recall from the ``Introduction'' chapter
		that the spline objects are really several splines
		taken together as a ``path''; from here on ``segment''
		will refer to one spline part of the whole spline object.)
		Once at least one segment is complete, another
		shift+click will stop editing the object, and the points
		placed so far will remain.
		It will be clear that at least one segment is complete
		when a curve is drawn between some of the control points.
		
		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgFirstTwoPt}
		\caption{First two control points starting a cubic spline.}
		\label{fig:first_two_points}
		\end{figure}
		
		Figure~\ref{fig:first_two_points} shows the start of a
		spline object before a segment is complete, and
		figure~\ref{fig:first_curve_between} shows the first
		curve appear after two more control points have completed
		the segment. The object in the figures is a \IXnewterm{cubic}
		spline, which requires four control points for a segment.
		(The number of control points per segment differs among the
		four available spline types.) 
		
		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgFirstSeg}
		\caption{Curve appears between control points of a cubic spline.}
		\label{fig:first_curve_between}
		\end{figure}

		If shift+click is given at the stage of
		figure~\ref{fig:first_two_points}, the two points will
		be deleted, but at the stage of
		figure~\ref{fig:first_curve_between} the points will
		be retained, and editing mode stopped. Editing
		is continued if the object is selected with a click,
		and shift+click given again.

		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgUnclosedCubic}
		\caption{Cubic spline, not closed.}
		\label{fig:first_cubic_unclosed}
		\end{figure}

		Figure~\ref{fig:first_cubic_unclosed} shows the spline
		object nearly complete. More points have been added,
		and another shift+click
		has terminated editing. \IXpov{} would reject the object
		as it is because the curve is not closed, and \IXpkg{}
		will not export it to \IXarg{SDL}.

		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgClosedCubic}
		\caption{Cubic spline, closed and complete.}
		\label{fig:first_cubic_closed}
		\end{figure}
		
		In figure~\ref{fig:first_cubic_closed} the object has
		been selected with a click. The selected state state is
		indicated by the dotted rectangle (on some platforms the
		rectangle might be dashed). With the whole object
		selected, a control point at an open end was selected,
		indicated by the cyan colored square, and moved to coincide
		with the matching control point. Now that it
		is properly closed, \IXpov{} will render the object.
		Also note that the two points that closed the curve are
		not the first or the last, but rather the second and
		the next-to--last. With the cubic spline curve, those
		are the points that must match, and the first and last
		are not drawn through. This differs in the other
		spline types. \IXpov{} requires a minimum of six
		points in a cubic spline (\IXpkg{} will draw a cubic
		spline with five points if points two and four coincide,
		but \IXpov{} will reject the object).
		
		The
		\IXpov{} \href{\URLPOVdocs}{documentation}
		on the
		\href{\URLPOVdocsLathe}{lathe}
		and
		\href{\URLPOVdocsPrism}{prism}
		objects will explain in more detail how points
		should be placed for each spline type, and other
		characteristics of the types.
		
		The cubic type of spline has been discussed so far
		because it is the default type for new objects if another
		type has not been selected. To choose among the four spline
		types, make sure that no existing object is selected by
		clicking the drawing area, outside of the selection
		rectangle of any selected object, with the primary
		mouse button. Next, click the drawing area with secondary
		button, which will invoke a ``pop-up'' menu. The
		drawing area menu is seen in
		figure~\ref{fig:canvas_popup_menu}.

		\begin{figure}[htbp]
		\centering
		\includegraphics{\ImgCtxMenuA}
		\caption{The drawing area ``pop-up'' menu.}
		\label{fig:canvas_popup_menu}
		\end{figure}

		The first (topmost) \IXarg{menu} item ``Curves''
		names the menu, and also serves to dismiss the menu
		without making a selection.
		The \IXarg{menu} items beginning with ``Set \ldots''
		select the type of object to be created. The first four
		of these offer the spline type, and the next two offer the
		\IXpov{} object type: prism or lathe. The last four
		items on the menu
		are equivalent to the ``File'' \IXarg{menu} items
		with the same labels
		(table~\ref{tab:File_menu}), and are placed on this menu
		for convenience. Note that an existing object can
		be changed between a lathe and prism, so it's not
		necessary to make that choice initially, but an existing
		object cannot be changed to a different spline type, so
		a type should be chosen before starting each object.

		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgUnclosedQuadratic}
		\caption{Quadratic spline, not closed.}
		\label{fig:first_quadratic_unclosed}
		\vspace{16pt}
		\includegraphics[width=\linewidth]{\ImgClosedQuadratic}
		\caption{Quadratic spline, closed and complete.}
		\label{fig:first_quadratic_closed}
		\end{figure}

		Figures~\ref{fig:first_quadratic_unclosed}~and~\ref{fig:first_quadratic_closed}
		are similar to
		figures~\ref{fig:first_cubic_unclosed}~and~\ref{fig:first_cubic_closed},
		but show a quadratic spline. In this case the points that
		must match to close the curve are the second and the
		\emph{last} (rather than the second-to--last
		point in the cubic type).
		\IXpov{} requires at least five points in the closed
		quadratic spline.

		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgUnclosedLinear}
		\caption{Linear spline, not closed.}
		\label{fig:first_linear_unclosed}
		\vspace{16pt}
		\includegraphics[width=\linewidth]{\ImgClosedLinear}
		\caption{Linear spline, closed and complete.}
		\label{fig:first_linear_closed}
		\end{figure}

		The equivalent for the linear spline type is seen in
		figures~\ref{fig:first_linear_unclosed}~and~\ref{fig:first_linear_closed}.
		There must be at least three points in the linear spline.		

		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgUnclosedBezier}
		\caption{\dtybezieru{} spline, not closed.}
		\label{fig:first_bezier_unclosed}
		\vspace{16pt}
		\includegraphics[width=\linewidth]{\ImgClosedBezier}
		\caption{\dtybezieru{} spline, closed and complete.}
		\label{fig:first_bezier_closed}
		\end{figure}

		The \dtybezierl{} spline object must be closed too, of course,
		as seen in
		figures~\ref{fig:first_bezier_unclosed}~and~\ref{fig:first_bezier_closed}.
		\IXpov{} will render a \dtybezierl{} spline object with only
		four points, which is one complete segment, if the first
		and last points coincide.
		The figures show a \dtybezierl{} object
		with two segments.

			\subsubsection{The Points of the \dtybezieru{} Type}%WX%5||||
			\label{sssec:editing_points_bezier}
			Quoting the start of section
			\ref{sec:creat_editing},
			``In \IXpkg{}, placing spline
			objects on the drawing area is meant to follow the
			\IXpov{} \href{\URLPOVdocs}{documentation}
			on
			\href{\URLPOVdocsLathe}{lathe}
			and
			\href{\URLPOVdocsPrism}{prism}
			objects.''
			That means that a point must be placed on the canvas
			in the same manner that a \IXnewterm{vector} would
			be added to a \IXarg{prism} or \IXarg{lathe} when
			editing \IXarg{SDL},
			with the same requirements of order and position.
			\IXpkgu{} does not add missing points or
			automatically close curves; but, a little help
			is provided when the graphical interface makes
			it necessary: when two points are clearly meant
			to coincide, \IXpkg{} may make them do so, because
			such precise placement with a mouse is very
			difficult. In general, a curve or \IXnewterm{sub-curve}
			must be closed with the user's knowledge of
			which points must coincide.
			
			The \IXbezn{} spline type is discussed here in more detail
			because:
			
			\begin{itemize}
				\item It differs from the other types more
						than they differ from each other.
				\item Regardless of the difference, mastering
						the \IXbezn{} might make mastering the
						other types easier.
				\item The \IXbezn{} might be the most
						useful type [in the author's opinion
						that is so].
			\end{itemize}
			
			To begin a new object, and to stop editing it,
			is accomplished the same way for all the spline types.
			If that was not made
			clear above, look forward to the
			\nameref{sssec:new_obj_summary} section.
			Once a \IXbezn{} spline object has been started
			it \emph{must} be remembered that that the whole
			curve is composed of segments, that each segment
			is composed of four control points, that the
			segments must be joined so that the last (fourth) point
			of the previous segment \IXarg{coincides} with
			the first point of the next segment,
			and that the whole curve must be closed by
			placing the last point of the last segment
			\IXarg{coincident} with the first point
			of the first segment of the curve.
			(A \IXbezn{} spline object
			may consist of a single segment, in which case
			the first and last points of this one segment
			must coincide.) Therefore, after first starting
			a \IXbezn{} curve, place the second, third and
			fourth points where they make sense, but do not
			move the mouse after placing the fourth point.
			Click again at the position of the fourth point
			to begin the next segment, and its
			first point will \IXarg{coincide} with the
			last of the previous segment, as it should.
			Finally, close the curve by placing a segment's
			last point just at the point that started the curve.
			
			Although \IXpkg{} does little to enforce these
			requirements, \IXpov{} will enforce them.
			\IXpkgu{} does provide a little help: if the
			fourth and first points of two segments in
			sequence were placed offset by a pixel or two,
			\IXpkg{} will join them, so a slight movement
			of the mouse before placing the first point
			of a new segment is not an irrecoverable error.
			If two points that should coincide are separated
			by more than a couple of pixels,
			\IXpkg{} will not join them, but they can be brought
			together with subsequent editing, i.e, after the
			initial creation of the object has been
			finished with another shift-key+primary-click.
			
			Some trial and error practice should make the
			points of this discussion more clear.
			(The ``Undo'' facility will always be very
			helpful.) After a few successful \IXbezn{}
			creations, try the other spline types and discover
			how they differ.


			\subsubsection{New Object Summary}%WX%5||||
			\label{sssec:new_obj_summary}
			As a summary of the creation of a new \IXarg{prism}
			or \IXarg{lathe}, consider this step-by--step list:
			
			\begin{enumerate}
				\item If any current object is \IXarg{selected}
						(a dashed or dotted box is shown and
						control points are shown with circles),
						\IXarg{deselect} it by clicking the
						drawing area outside the selected object's
						bounding box.
				\item Set the type of \IXarg{spline}
						to be created by clicking the
						drawing area with the secondary \IXarg{mouse}
						button and choosing from the \IXarg{menu},
						as shown in
						figure~\ref{fig:canvas_popup_menu}.
						Do not forget this step because the
						\IXarg{spline} type of an existing
						object cannot be changed.
				\item Optionally, choose whether the new object
						will be a \IXarg{prism} or \IXarg{lathe}
						from the drawing area \IXarg{menu}.
						This can be changed for an existing
						object, so it is not necessary initially.
				\item Enter editing mode:
						with the shift-key depressed, click the
						canvas with
						the primary mouse button at a suitable
						place for the first control point, and
						a circle representing the point should appear.
				\item Release the shift-key before clicking
						the \IXarg{canvas} again, or the object
						will be cancelled. Of course, the object
						may be cancelled intentionally.
				\item Click to add points, in a manner suitable
						for the type of spline being created,
						until the object is complete, or at
						least until a curve segment is drawn between
						points (so that the object will not
						be cancelled and will remain for further
						editing).
				\item Leave editing mode with a primary
						mouse button click with the shift
						key depressed.
			\end{enumerate}


		\subsection{Continued Editing}%WX%4||||
		\label{ssec:cont_editing}
			\subsubsection{Object Properties}%WX%5||||
			\label{sssec:object_props}
			\subsubsection{Discontinuous Objects}%WX%5||||
			\label{sssec:discont_objects}

	\section{Useful Transforms}%WX%3||||
	\label{sec:useful_transforms}
	Like most objects in a \IXpov{} \IXarg{scene},
	the objects exported by \IXpkg{} need to be
	\IXarg{\emph{transformed}} in various ways to be
	placed in the scene with a particular size and
	orientation. The \IXarg{\emph{translate}},
	\IXarg{\emph{scale}}, and
	\IXarg{\emph{rotate}} keywords are used to
	accomplish this. Also, a collection of transformations
	may be placed in a \IXarg{\emph{transform}} object.
	This section will suggest some useful initial transforms
	of \IXarg{prisms} and \IXarg{lathes} exported
	by \IXpkg{}.
	
	It was mentioned in \nameref{sec:creat_editing}
	that the \IXarg{coordinates} of the \IXpkg{}
	\IXarg{drawing area}, or ``\IXarg{canvas},''
	are not similar to the \IXpov{}
	\IXarg{\emph{coordinate system}}. In fact, the \IXarg{SDL}
	allows the \IXpov{} \IXarg{coordinate system}
	to be modified, and so assumptions made by a program
	such as \IXpkg{} might not be valid. It is better that
	the user understand \IXpov{} \IXarg{transforms} and
	place the objects logically. \IXpkgu{} declares a number
	of necessary values describing the (un-scaled) extremes
	and positions of objects, and using these declarations,
	the typical transforms are routine.


		\subsection{Example of Exported SDL}%WX%4||||
		\label{ssec:ex_sdl_exported}
		\begin{povsdl}
			{\small
			\begin{verbatim}
			// POV include file
			// Generated by epspline
			
			
			#ifndef ( INCLUDED_foo_inc )
			#declare INCLUDED_foo_inc = 1;
			
			#declare Foo_width = 300.000000;
			#declare Foo_height = 99.379610;
			#declare Foo_left = 100.000000;
			#declare Foo_right = 400.000000;
			#declare Foo_top = 100.000000;
			#declare Foo_bottom = 199.379610;
			#declare Foo_max_extent = max(Foo_width, Foo_height);
			
			#declare Foo_NORMAL_TRANSFORM = transform {
			  translate <-Foo_left - Foo_width / 2, 0, -Foo_top - Foo_height / 2>
			  scale <1 / Foo_max_extent, 1, 1 / Foo_max_extent>
			  scale <1, 1, -1>
			}
			
			#declare Foo =
			prism { bezier_spline linear_sweep -1.000000, 1.000000
			  , 8
			  , <100.000000, 100.000000>
			  , <186.000000, 162.644928>
			  , <315.000000, 160.717391>
			  , <400.000000, 100.000000>
			  , <400.000000, 100.000000>
			  , <316.000000, 232.036232>
			  , <186.000000, 233.000000>
			  , <100.000000, 100.000000>
			#ifdef ( Foo_USE_NORMAL_TRANSFORM )
			  transform { Foo_NORMAL_TRANSFORM }
			#end
			}
			
			#declare I_foo_inc_width = 300.000000;
			#declare I_foo_inc_height = 99.379610;
			#declare I_foo_inc_left = 100.000000;
			#declare I_foo_inc_right = 400.000000;
			#declare I_foo_inc_top = 100.000000;
			#declare I_foo_inc_bottom = 199.379610;
			
			#end // #ifdef ( INCLUDED_foo_inc )
			\end{verbatim}
			}%small
		\caption{One spline object named ``Foo'' exported as
			\emph{scene description language}.}
		\label{pvlst:sdl_one_obj}
		\end{povsdl}
	
		An example of the \IXarg{SDL} exported by \IXpkg{}
		is shown in listing~\ref{pvlst:sdl_one_obj}.
		The name of the object is ``Foo'', and the file it was
		exported to is named ``foo.inc''
		This ``include file'' begins (after an initial
		comment) with a guard against re-inclusion by testing and
		declaring
		``\texttt{INCLUDED\_foo\_inc}.''
		The guard name will
		integrate the file name, so it will probably
		be unique. If the file is
		included a second time the \texttt{\#ifndef} test will fail
		and everything will be ignored up to the matching
		\texttt{\#end} near the end of the file. This common guard
		allows one include file to be used by several other files
		without conflict.
		
		Following the guard, constants are declared for the
		dimensions and position of the the object.
		These values are collected
		by \IXpkg{} as the curve is calculated
		(i.e., \IXarg{interpolated}) for display,
		and are limited in accuracy by the resolution of the
		\IXarg{interpolation}, but they should be precise enough
		for any scene.
		
		Appearing next, just before the spline object
		declaration, is the declaration of an optional transform,
		named ``\texttt{Foo\_NORMAL\_TRANSFORM}.''
		This is only applied if
		``\texttt{Foo\_USE\_NORMAL\_TRANSFORM}''
		is declared before the
		file is included. If used, the transform scales the object
		(not including the \emph{\IXarg{sweep}} of a \IXarg{prism})
		to one unit on the axis with the greater extent. It also
		centers the object at the origin, and inverts the object
		along the $z$-axis for the prism,
		or the $y$-axis for the lathe (because of the difference in view
		between \IXpov{} and \IXpkg{}).
		
		Next, the object is declared. If there was more than
		one object in listing~\ref{pvlst:sdl_one_obj},
		then the sequence of constants-transform--object would
		be repeated for each.
		
		Finally, constants are declared that are similar to those
		declared for objects
		but which pertain to all the objects in the file.
		As listing~\ref{pvlst:sdl_one_obj} shows only one object,
		these happen to be the same as the constants for
		``\texttt{Foo},'' but if a file is composed of several
		objects meant to keep their relative positions and sizes,
		then these final constants are useful.


		\subsection{Example with a Lathe and Prism}%WX%4||||
		\label{ssec:ex_lath_and_prism}
		Consider a scene with two objects, a lathe and a
		prism, that should be rendered together. The lathe
		is named ``Cup,'' and the prism is named ``Handle.''
		Drawn quickly in \IXpkg{}, they might look like
		figure~\ref{fig:cup_doodle}.
		Hopefully, it is obvious which objects are assigned
		the names. Since \IXarg{lathes} are rotated around
		the $y$-axis, ``Cup'' is the profile of half of a cup.
		Also, the left-most points of ``Cup'' are at the
		horizontal point zero. If those points had a positive
		offset, then the cup would have a hole in the bottom.
		If they had a negative offset, \IXpov{} would reject
		the object and exit with an error message: lathes may
		not have negative values on the rotated axis.

		\begin{figure}[htbp]
		\centering
		\includegraphics[width=\linewidth]{\ImgCupDoodle}
		\caption{A simple cup on the \dtypkg{} canvas.}
		\label{fig:cup_doodle}
		\end{figure}

		After these objects
		are exported to an include file, ``cup.inc,''
		a main scene file is necessary to render the cup
		with \IXpov{}. A minimal scene file, ``cup.pov,'' is shown in
		listing~\ref{pvlst:sdl_coffee_cup_pov}.
		The \IXpov{}
		\href{http://www.povray.org/documentation/}{documentation}
		will explain the \IXarg{language} (\IXarg{SDL}).
		
		\begin{povsdl}
			{\small
			\begin{verbatim}
			#version 3.5;
			#include "colors.inc"
			
			light_source { <20, 20, -20> color White }
			
			camera {
			    location <0, 0.75, -4>
			    look_at <0, 0.25, 0>
			    right x * image_width / image_height
			    angle 45
			}
			
			#declare CupTexture = texture { pigment { color LightBlue } }
			#declare BoxTexture = texture { pigment { color DarkGreen } }
			
			#include "cup.inc"
			
			#declare CoffeeCupRaw = union {
			    object { Handle
			        rotate x * -90
			    }
			    object { Cup }
			}
			
			#declare CoffeeCup = object {
			    CoffeeCupRaw
			    translate <0, -Cup_top - Cup_height / 2, 0>
			    scale 1 / Cup_height
			    scale <1, -1, 1>
			    texture { CupTexture }
			}
			
			object { CoffeeCup translate <0, 0.5, 0> }
			// somewhere to put the cup down:
			box { <-1, -0.25, -0.75> <1, 0, 0.75>
			    texture { BoxTexture }
			}
			\end{verbatim}
			}%small
		\caption{\dtypov{} SDL for a simple coffee cup scene.}
		\label{pvlst:sdl_coffee_cup_pov}
		\end{povsdl}

		Near the middle of listing~\ref{pvlst:sdl_coffee_cup_pov}
		the file
		``cup.inc'' is included. Next, the the two objects
		``Handle'' and ``Cup'' are bound together in a
		\IXnewterm{union} named ``CoffeeCupRaw,'' which has
		been called `Raw' because it is
		not yet an object ready to be presented.
		The first important transform is stated in the union:
		the handle is rotated by -90 degrees. Recall from
		\nameref{sec:creat_editing} that in the
		2D view of outlines in \IXpkg{} the prism is seen
		parallel to the $y$-axis, and the lathe is seen
		perpendicular to the $y$-axis. Therefore, rotating
		the handle brings it to the same line-of--sight as
		the cup.
		
		The union CoffeeCupRaw has put the the handle in juxtaposition
		to the cup, but the whole is still at a size and offset
		according to the units used in the \IXpkg{} interface.
		In the declaration of ``CoffeeCup'' the object is
		is centered (centering is the author's preference) and
		scaled to one unit on the axis which makes the most sense
		for this scene, the $y$-axis. In
		\nameref{ssec:ex_sdl_exported}
		the constants declared for an object were introduced.
		Some of these constants are used in transforming
		the coffee cup. The \emph{\IXarg{translate}}
		vector has zero at $x$ and $z$, but at $y$ the
		`top' offset is removed and half the raw height
		is subtracted. This $y$ translation is negative
		because the view of lathes in \IXpkg{} has $0$
		at top and increases downward. The next statement,
		a \emph{\IXarg{scale}} transform, reduces the height
		to one unit, and next another \emph{scale}
		inverts the cup along the $y$-axis for the same
		reason given for negative \IXarg{translation}.
		
		Finally, the cup is placed in the scene by adding
		it in an ``\IXarg{object}'' statement,
		without ``\verb!#declare!,'' and shifting it again
		along $y$ so that the bottom of the cup
		is at $0$. To increase
		the awe that will move the the patrons of \emph{MoMA},
		a box is placed so that the cup rests on it.
		The reader may bask in this profound expression
		by viewing figure~\ref{fig:cup_doodle_render}.

		\begin{figure}[htbp]
		\centering
		\includegraphics[width=0.75\linewidth]{\ImgCupDoodleRender}
		\caption{The simple cup rendered.}
		\label{fig:cup_doodle_render}
		\end{figure}


	\section{Tips}%WX%3||||
	\label{sec:tips_tricks}


